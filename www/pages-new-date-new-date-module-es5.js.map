{"version":3,"sources":["webpack:///src/app/pages/new-date/new-date.page.html","webpack:///src/app/pages/new-date/new-date-routing.module.ts","webpack:///src/app/pages/new-date/new-date.module.ts","webpack:///src/app/pages/new-date/new-date.page.scss","webpack:///src/app/pages/new-date/new-date.page.ts"],"names":["routes","path","component","NewDatePageRoutingModule","imports","forChild","exports","NewDatePageModule","declarations","NewDatePage","apiService","router","plt","alertController","nav","loadingController","alertCtrl","datePipe","loadingSpin","isTemp","ubicacion","isLoaded","isPublicOrder","reset","getCurrentNavigation","extras","state","orderDetails","order","token","workerId","publicWorksId","tempOrderId","latitude","longitude","tmpDate","Date","getTime","minDate","transform","maxDate","proposedDate","presentAlert","proposedTime","description","console","log","substr","orderStartAsync","dateFormatted","formatDate","reqField","fieldName","fieldValue","orderId","JSON","stringify","processOrder","message","back","create","header","subHeader","buttons","alert","present","navigateForward","date","d","month","getMonth","day","getDate","year","getFullYear","hours","getHours","toString","minute","getMinutes","seconds","getSeconds","length","mensaje","putItemsByMethod","toPromise","then","result","dismiss","text","role","cssClass","handler","navigate","e","selector","template"],"mappings":"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","file":"pages-new-date-new-date-module-es5.js","sourcesContent":["export default \"<ion-header>\\n    <ion-toolbar color=\\\"dark\\\">\\n        <ion-buttons slot=\\\"start\\\">\\n            <ion-buttons slot=\\\"start\\\">\\n                <ion-back-button defaultHref=\\\"/\\\"></ion-back-button>\\n            </ion-buttons>\\n        </ion-buttons>\\n        <ion-title>Solicitud Cambio de Fecha</ion-title>\\n    </ion-toolbar>\\n</ion-header>\\n\\n<ion-content>\\n    <ion-grid>\\n        <ion-row>\\n            <ion-col>\\n                <ion-item class=\\\".ion-justify-content-start\\\" lines=\\\"none\\\">\\n                    <ion-avatar>\\n                        <img src=\\\"{{orderDetails.occupationImage}}\\\" class=\\\".ion-align-self-center\\\" />\\n                        <ion-grid>\\n                            <ion-row class=\\\"ion-text-center\\\">\\n                                <ion-col>\\n                                    <ion-text color=\\\"dark\\\">\\n                                        <b>\\n                                          <font size=\\\"2\\\">{{orderDetails.occupationName}}</font>\\n                                      </b>\\n                                    </ion-text>\\n                                </ion-col>\\n                            </ion-row>\\n                        </ion-grid>\\n                    </ion-avatar>\\n                    <ion-label>\\n                        <ion-text color=\\\"dark\\\">\\n                            <b>\\n                              <font size=\\\"1\\\">Nombre del solicitante</font>\\n                          </b>\\n                        </ion-text>\\n                        <ion-text color=\\\"dark\\\">\\n                            <p>{{ orderDetails.clientName}}</p>\\n                        </ion-text>\\n                        <ion-text color=\\\"dark\\\">\\n                            <b>\\n                              <font size=\\\"1\\\">Direcci√≥n</font>\\n                          </b>\\n                        </ion-text>\\n                        <ion-text color=\\\"dark\\\">\\n                            <p>{{orderDetails.address}}</p>\\n                        </ion-text>\\n\\n                        <ion-text color=\\\"dark\\\">\\n                            <b>\\n                              <font size=\\\"1\\\">Fecha de la orden</font>\\n                          </b>\\n                        </ion-text>\\n                        <ion-text color=\\\"dark\\\">\\n                            <p>{{ orderDetails.workDate | date:'medium' }}</p>\\n                        </ion-text>\\n                        <ion-text color=\\\"dark\\\">\\n                            <p>&nbsp;</p>\\n                        </ion-text>\\n                    </ion-label>\\n                </ion-item>\\n            </ion-col>\\n        </ion-row>\\n    </ion-grid>\\n    <ion-toolbar style=\\\"margin-top: -5px;\\\" *ngIf=\\\"isLoaded\\\">\\n        <div class=\\\"ion-padding\\\">\\n            <ion-button expand=\\\"block\\\" type=\\\"submit\\\" class=\\\"primary-btn\\\" (click)=\\\"proposeNewDate()\\\">\\n                <ion-icon name=\\\"calendar-number\\\"></ion-icon>Proponer nueva fecha\\n            </ion-button>\\n        </div>\\n        <div>\\n            <ion-card>\\n                <ion-card-content>\\n                    <ion-list lines=\\\"full\\\" class=\\\"ion-no-margin ion-no-padding\\\">\\n                        <ion-item>\\n                            <ion-label>Seleccione fecha:</ion-label>\\n                            <ion-datetime [(ngModel)]=\\\"proposedDate\\\" display-format=\\\"MMM DD YYYY\\\" picker-format=\\\"MM DD YYYY\\\" [min]=\\\"minDate\\\" [max]=\\\"maxDate\\\"></ion-datetime>\\n                        </ion-item>\\n                        <ion-item>\\n                            <ion-label>Seleccione Horario:</ion-label>\\n                            <ion-datetime [(ngModel)]=\\\"proposedTime\\\" display-format=\\\"HH mm\\\" picker-format=\\\"HH:mm\\\"></ion-datetime>\\n                        </ion-item>\\n                        <ion-item>\\n                            <ion-label position=\\\"floating\\\">Justifique el cambio de fecha:</ion-label>\\n                            <ion-textarea [(ngModel)]=\\\"description\\\" type=\\\"text\\\" inputmode=\\\"latin-name\\\" rows=\\\"4\\\"></ion-textarea>\\n                        </ion-item>\\n                    </ion-list>\\n                </ion-card-content>\\n            </ion-card>\\n        </div>\\n        <!-- <ion-fab vertical=\\\"bottom\\\" horizontal=\\\"end\\\" slot=\\\"fixed\\\">\\n            <div *ngIf=\\\"orderDetails.status == 'In Progress'\\\">\\n                <ion-fab-button (click)=\\\"setCloseOrder()\\\" color=\\\"xjobs\\\">\\n                    <ion-icon name=\\\"flag\\\"></ion-icon>\\n                </ion-fab-button>\\n            </div>\\n        </ion-fab> -->\\n    </ion-toolbar>\\n</ion-content>\";","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { NewDatePage } from './new-date.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: NewDatePage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class NewDatePageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { NewDatePageRoutingModule } from './new-date-routing.module';\n\nimport { NewDatePage } from './new-date.page';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    NewDatePageRoutingModule\n  ],\n  declarations: [NewDatePage]\n})\nexport class NewDatePageModule {}\n","export default \"p {\\n  white-space: normal !important;\\n  text-align: justify;\\n  font-size: 10px;\\n  line-height: 1.4;\\n}\\n\\nion-item {\\n  --border-radius: 1em;\\n  --border-width: 0.1em !important;\\n  margin-bottom: 0.3em;\\n}\\n\\n.icon {\\n  display: inline-block;\\n  font-size: 12px;\\n  vertical-align: middle;\\n}\\n\\n.text {\\n  font-size: 12px;\\n  display: inline-block;\\n  vertical-align: middle;\\n  color: darkblue;\\n}\\n\\n#map_canvas {\\n  width: 100%;\\n  height: 45vh;\\n}\\n\\nion-avatar {\\n  width: 90px;\\n  height: 90px;\\n  margin-left: 10px;\\n  margin-right: 30px;\\n  margin-top: -35px;\\n  border: solid 3px #D95A2B;\\n}\\n\\n.gallery {\\n  width: 100%;\\n  height: 48vh;\\n}\\n\\nion-card {\\n  display: flex;\\n  flex-direction: column;\\n  margin: 0 !important;\\n  width: 500px;\\n}\\n\\nion-content ion-card {\\n  width: 100%;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9kYWx2YXJhZG8vZGVzYXJyb2xsby9lbmlhY2d0L2lvbmljL3hKb2JzL3hKb2JzV29ya2VyL3NyYy9hcHAvcGFnZXMvbmV3LWRhdGUvbmV3LWRhdGUucGFnZS5zY3NzIiwic3JjL2FwcC9wYWdlcy9uZXctZGF0ZS9uZXctZGF0ZS5wYWdlLnNjc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFDSSw4QkFBQTtFQUNBLG1CQUFBO0VBQ0EsZUFBQTtFQUNBLGdCQUFBO0FDQ0o7O0FERUE7RUFDSSxvQkFBQTtFQUNBLGdDQUFBO0VBQ0Esb0JBQUE7QUNDSjs7QURFQTtFQUNJLHFCQUFBO0VBQ0EsZUFBQTtFQUNBLHNCQUFBO0FDQ0o7O0FERUE7RUFDSSxlQUFBO0VBQ0EscUJBQUE7RUFDQSxzQkFBQTtFQUNBLGVBQUE7QUNDSjs7QURFQTtFQUNJLFdBQUE7RUFDQSxZQUFBO0FDQ0o7O0FERUE7RUFDSSxXQUFBO0VBQ0EsWUFBQTtFQUNBLGlCQUFBO0VBQ0Esa0JBQUE7RUFDQSxpQkFBQTtFQUNBLHlCQUFBO0FDQ0o7O0FERUE7RUFDSSxXQUFBO0VBQ0EsWUFBQTtBQ0NKOztBREVBO0VBQ0ksYUFBQTtFQUNBLHNCQUFBO0VBQ0Esb0JBQUE7RUFDQSxZQUFBO0FDQ0o7O0FERUE7RUFDSSxXQUFBO0FDQ0oiLCJmaWxlIjoic3JjL2FwcC9wYWdlcy9uZXctZGF0ZS9uZXctZGF0ZS5wYWdlLnNjc3MiLCJzb3VyY2VzQ29udGVudCI6WyJwIHtcbiAgICB3aGl0ZS1zcGFjZTogbm9ybWFsICFpbXBvcnRhbnQ7XG4gICAgdGV4dC1hbGlnbjoganVzdGlmeTtcbiAgICBmb250LXNpemU6IDEwcHg7XG4gICAgbGluZS1oZWlnaHQ6IDEuNDtcbn1cblxuaW9uLWl0ZW0ge1xuICAgIC0tYm9yZGVyLXJhZGl1czogMWVtO1xuICAgIC0tYm9yZGVyLXdpZHRoOiAwLjFlbSAhaW1wb3J0YW50O1xuICAgIG1hcmdpbi1ib3R0b206IDAuM2VtO1xufVxuXG4uaWNvbiB7XG4gICAgZGlzcGxheTogaW5saW5lLWJsb2NrO1xuICAgIGZvbnQtc2l6ZTogMTJweDtcbiAgICB2ZXJ0aWNhbC1hbGlnbjogbWlkZGxlO1xufVxuXG4udGV4dCB7XG4gICAgZm9udC1zaXplOiAxMnB4O1xuICAgIGRpc3BsYXk6IGlubGluZS1ibG9jaztcbiAgICB2ZXJ0aWNhbC1hbGlnbjogbWlkZGxlO1xuICAgIGNvbG9yOiBkYXJrYmx1ZTtcbn1cblxuI21hcF9jYW52YXMge1xuICAgIHdpZHRoOiAxMDAlO1xuICAgIGhlaWdodDogNDV2aDtcbn1cblxuaW9uLWF2YXRhciB7XG4gICAgd2lkdGg6IDkwcHg7XG4gICAgaGVpZ2h0OiA5MHB4O1xuICAgIG1hcmdpbi1sZWZ0OiAxMHB4O1xuICAgIG1hcmdpbi1yaWdodDogMzBweDtcbiAgICBtYXJnaW4tdG9wOiAtMzVweDtcbiAgICBib3JkZXI6IHNvbGlkIDNweCAjRDk1QTJCO1xufVxuXG4uZ2FsbGVyeSB7XG4gICAgd2lkdGg6IDEwMCU7XG4gICAgaGVpZ2h0OiA0OHZoO1xufVxuXG5pb24tY2FyZCB7XG4gICAgZGlzcGxheTogZmxleDtcbiAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xuICAgIG1hcmdpbjogMCAhaW1wb3J0YW50O1xuICAgIHdpZHRoOiA1MDBweDtcbn1cblxuaW9uLWNvbnRlbnQgaW9uLWNhcmQge1xuICAgIHdpZHRoOiAxMDAlO1xufSIsInAge1xuICB3aGl0ZS1zcGFjZTogbm9ybWFsICFpbXBvcnRhbnQ7XG4gIHRleHQtYWxpZ246IGp1c3RpZnk7XG4gIGZvbnQtc2l6ZTogMTBweDtcbiAgbGluZS1oZWlnaHQ6IDEuNDtcbn1cblxuaW9uLWl0ZW0ge1xuICAtLWJvcmRlci1yYWRpdXM6IDFlbTtcbiAgLS1ib3JkZXItd2lkdGg6IDAuMWVtICFpbXBvcnRhbnQ7XG4gIG1hcmdpbi1ib3R0b206IDAuM2VtO1xufVxuXG4uaWNvbiB7XG4gIGRpc3BsYXk6IGlubGluZS1ibG9jaztcbiAgZm9udC1zaXplOiAxMnB4O1xuICB2ZXJ0aWNhbC1hbGlnbjogbWlkZGxlO1xufVxuXG4udGV4dCB7XG4gIGZvbnQtc2l6ZTogMTJweDtcbiAgZGlzcGxheTogaW5saW5lLWJsb2NrO1xuICB2ZXJ0aWNhbC1hbGlnbjogbWlkZGxlO1xuICBjb2xvcjogZGFya2JsdWU7XG59XG5cbiNtYXBfY2FudmFzIHtcbiAgd2lkdGg6IDEwMCU7XG4gIGhlaWdodDogNDV2aDtcbn1cblxuaW9uLWF2YXRhciB7XG4gIHdpZHRoOiA5MHB4O1xuICBoZWlnaHQ6IDkwcHg7XG4gIG1hcmdpbi1sZWZ0OiAxMHB4O1xuICBtYXJnaW4tcmlnaHQ6IDMwcHg7XG4gIG1hcmdpbi10b3A6IC0zNXB4O1xuICBib3JkZXI6IHNvbGlkIDNweCAjRDk1QTJCO1xufVxuXG4uZ2FsbGVyeSB7XG4gIHdpZHRoOiAxMDAlO1xuICBoZWlnaHQ6IDQ4dmg7XG59XG5cbmlvbi1jYXJkIHtcbiAgZGlzcGxheTogZmxleDtcbiAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcbiAgbWFyZ2luOiAwICFpbXBvcnRhbnQ7XG4gIHdpZHRoOiA1MDBweDtcbn1cblxuaW9uLWNvbnRlbnQgaW9uLWNhcmQge1xuICB3aWR0aDogMTAwJTtcbn0iXX0= */\";","import { Component, OnInit } from '@angular/core';\nimport { ApiService } from '../../services/api.service';\nimport { Router } from '@angular/router';\nimport { Platform, AlertController, NavController, LoadingController } from '@ionic/angular';\nimport { WorkOrderHistoryDTO } from '../../models/dto/WorkOrderHistoryDTO';\nimport { DatePipe } from '@angular/common';\nimport { RequestFields } from '../../models/bo/request-fields';\n\n@Component({\n  selector: 'app-new-date',\n  templateUrl: './new-date.page.html',\n  styleUrls: ['./new-date.page.scss'],\n})\nexport class NewDatePage implements OnInit {\n  \n  loadingSpin=null;\n  orderDetails: WorkOrderHistoryDTO;\n  token: string;\n  workerId: string;\n  isTemp: string = \"false\";\n  ubicacion: boolean = false;\n  proposedDate: string;\n  proposedTime: string;\n  description: string;\n  minDate: string;\n  maxDate: string;\n  isLoaded = false;\n  isPublicOrder = false;\n\n  constructor(private apiService: ApiService,\n    private router: Router,\n    private plt: Platform,\n    private alertController: AlertController,\n    private nav: NavController,\n    private loadingController: LoadingController,\n    private alertCtrl: AlertController,\n    private datePipe: DatePipe\n    ) { \n      this.isLoaded = true;\n      this.reset();\n      if (this.router.getCurrentNavigation().extras.state) {\n        this.orderDetails = this.router.getCurrentNavigation().extras.state.order;\n        this.token = this.router.getCurrentNavigation().extras.state.token;\n        this.workerId = this.router.getCurrentNavigation().extras.state.workerId;\n        if(this.orderDetails.publicWorksId && this.orderDetails.publicWorksId > 0){\n          this.isPublicOrder = true;\n        }\n        if (this.orderDetails.tempOrderId) {\n          this.isTemp = \"true\";\n        }\n        if (this.orderDetails.latitude && this.orderDetails.longitude) {\n          this.ubicacion = true;\n        }\n      }\n    }\n\n  ngOnInit() {\n  }\n\n  reset() {\n    let tmpDate = new Date();\n    tmpDate = new Date(tmpDate.getTime() + (1000 * 60 * 60 * 24));\n    this.minDate = this.datePipe.transform(tmpDate, \"yyyy-MM-dd\");\n    tmpDate = new Date(tmpDate.getTime() + (60 * (1000 * 60 * 60 * 24)));\n    this.maxDate = this.datePipe.transform(tmpDate, \"yyyy-MM-dd\");\n    this.isLoaded = true;\n  }\n\n  proposeNewDate() {\n    if (!this.proposedDate) {\n      this.presentAlert(\"No ha ingresado fecha.\", false);\n    } else if (!this.proposedTime) {\n      this.presentAlert(\"No ha ingresado horario.\", false);\n    } else if (!this.description) {\n      this.presentAlert(\"No ha ingresado comentario.\", false);\n    } else {\n      \n      console.log('proposedDate '+ this.proposedDate + ' proposedTime ' + this.proposedTime.substr(11,5));\n      this.orderStartAsync();\n    }\n  }\n \n  async orderStartAsync(){\n    const dateFormatted  = this.formatDate(this.proposedDate);\n    const reqField: RequestFields[] = [\n      { fieldName: \"workOrderId\", fieldValue: this.orderDetails.orderId + \"\" },\n      { fieldName: \"workerId\", fieldValue: this.workerId },\n      { fieldName: \"status\", fieldValue: 'CHANGE_DATE' },\n      { fieldName: \"isPublicOrder\", fieldValue: this.isPublicOrder+\"\" },\n      { fieldName: \"publicOrderId\", fieldValue: this.orderDetails.publicWorksId+\"\" },\n      { fieldName: \"date\", fieldValue: dateFormatted+\"\" },\n      { fieldName: \"time\", fieldValue: dateFormatted+\"\" },\n      { fieldName: \"observation\", fieldValue: this.description+\"\" },\n    ];\n    console.log('Request ' + JSON.stringify(reqField));\n    this.processOrder(reqField);\n   \n  }\n\n  async presentAlert(message: any, back: boolean) {\n    const alert = await this.alertController.create({\n      header: \"Job Exchange\",\n      subHeader: \"Solicitud de cambio de fecha enviado\",\n      message,\n      buttons: [\"OK\"],\n    });\n\n    await alert.present();\n\n    if (back) {\n      this.nav.navigateForward(\"/home\");\n    }\n  }\n\n  formatDate(date) {\n    var d = new Date(date);\n    let month = '' + (d.getMonth() + 1);\n    let day = '' + d.getDate();\n    let year = d.getFullYear();\n    let hours = d.getHours().toString();\n    let minute = d.getMinutes().toString();\n    let seconds = d.getSeconds().toString();\n    if (month.length < 2) {\n      month = '0' + month;\n    }\n    if (day.length < 2) {\n      day = '0' + day;\n    }\n    if (hours.length < 2) {\n      hours = '0' + hours;\n    }\n    if (minute.length < 2) {\n      minute = '0' + minute;\n    }\n    if (seconds.length < 2) {\n      seconds = '0' + seconds;\n    }\n    return year+\"-\"+month+\"-\"+day+\" \"+hours+\":\"+minute+\":\"+seconds;\n  }\n\nasync processOrder(reqField) {\n  this.loadingSpin = await this.loadingController.create({\n   message: \"Validando el usuario...\",\n });\n await this.loadingSpin.present();\n\n//  console.log('reqField',reqField);\n\n let mensaje = \"\";\n this.apiService\n   .putItemsByMethod(\n     \"woAssigned\",\n     \"acceptOrRejectOrders\",\n     reqField,\n     this.token\n   )\n   .toPromise()\n   .then( async (result) => {\n     console.log('result',result);\n     if (result === -1) {\n      mensaje = \"Alguien m√°s acepto esta orden con anterioridad.\";\n     } else if (result === 1) {\n      mensaje = \"Orden actualizada exitosamente.\";\n     }\n\n     if(this.loadingSpin != null){\n      this.loadingSpin.dismiss();\n      }\n\n\n     console.log(mensaje);\n\n     const alert = await this.alertCtrl.create({\n      header: \"Job Exchange\",\n      subHeader: \"Solicitud de cambio de fecha enviado\",\n      message: 'cambio de fecha de orden registrado',\n      buttons: [\n        {\n          text: \"OK\",\n          role: \"cancel\",\n          cssClass: \"secondary\",\n          handler: () => {\n            console.log(\"Confirm OK\");\n          },\n        },\n      ],\n    });\n  \n    await alert.present();\n    this.router.navigate(['/home']);\n\n   })\n   .catch((e) => {\n     console.log(\"error,\", e);\n     if(this.loadingSpin != null){\n      this.loadingSpin.dismiss();\n      }\n  });\n\n   \n}\n\n}\n"]}